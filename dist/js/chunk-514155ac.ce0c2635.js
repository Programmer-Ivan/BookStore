(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-514155ac"],{"0f42":function(t,e,s){"use strict";s("52ff")},1112:function(t,e,s){"use strict";s("d54c")},3043:function(t,e,s){},"40b9":function(t,e,s){"use strict";s("3043")},"52ff":function(t,e,s){},"58e2":function(t,e,s){"use strict";s("9f01")},"5ad3":function(t,e,s){"use strict";var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tab-control"},t._l(t.control,(function(e,n){return s("div",{class:{active:n===t.currentIndex},on:{click:function(e){return t.itemClick(n)}}},[s("span",[t._v(t._s(e))])])})),0)},o=[],r={name:"TabControl",props:{control:{type:Array,default:function(){return[]}}},data:function(){return{currentIndex:0}},methods:{itemClick:function(t){this.currentIndex=t,this.$emit("TabControl",t)}}},a=r,i=(s("0f42"),s("2877")),c=Object(i["a"])(a,n,o,!1,null,"603acd81",null);e["a"]=c.exports},"60ba":function(t,e,s){"use strict";s("67fe")},"67fe":function(t,e,s){},"6c82":function(t,e,s){"use strict";s("c142")},"6d71":function(t,e,s){"use strict";var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"goods-list"},t._l(t.goods,(function(t){return s("goods-item",{attrs:{type:t}})})),1)},o=[],r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"goods-item",on:{click:t.itemClick}},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.type.cover_url,expression:"type.cover_url"}],attrs:{alt:""},on:{load:t.imageLoad}}),s("div",[s("p",{staticClass:"title"},[t._v(t._s(t.type.title))]),s("span",{staticClass:"price"},[s("small",[t._v("￥")]),t._v(t._s(t.type.price))]),s("span",{staticClass:"collect"},[t._v(t._s(t.type.collects_count))])])])},a=[],i={name:"GoodsItem",props:{type:{type:Object,default:function(){return{}}}},methods:{imageLoad:function(){this.$bus.$emit("itemImageLoad")},itemClick:function(){this.$router.push({path:"/detail",query:{id:this.type.id}})}}},c=i,l=(s("58e2"),s("2877")),u=Object(l["a"])(c,r,a,!1,null,"0650a70e",null),f=u.exports,d={name:"Goods",props:{goods:{type:Array,default:function(){return[]}}},components:{GoodsItem:f},methods:{}},p=d,m=(s("1112"),Object(l["a"])(p,n,o,!1,null,"503c700b",null));e["a"]=m.exports},"9f01":function(t,e,s){},b3d7:function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"home"}},[s("nav-bar",{staticClass:"nav-bar",attrs:{bg:"rgb(255, 129, 152)",color:"#fff"}},[s("div",{attrs:{slot:"center"},slot:"center"},[t._v("兄弟图书")])]),s("tab-control",{directives:[{name:"show",rawName:"v-show",value:t.isTabFixed,expression:"isTabFixed"}],ref:"controlOffsetTop1",staticClass:"tabControl",attrs:{control:["畅销","新书","精选"]},on:{TabControl:t.itemTab}}),s("scroll",{ref:"scroll",staticClass:"content",attrs:{probeTypes:3,"pull-up-load":!0},on:{scroll:t.scrollPotion,pullingUp:t.pullingUp}},[s("div",{ref:"OffsetHeight"},[s("swiper",{attrs:{banners:t.goodsBanner},on:{bannersLoad:t.bannersLoad}}),s("RecommendView",{attrs:{recommends:t.recommends}})],1),s("tab-control",{ref:"controlOffsetTop",attrs:{control:["畅销","新书","精选"]},on:{TabControl:t.itemTab}}),s("GoodsList",{attrs:{goods:t.showGoods}})],1),s("back-top",{directives:[{name:"show",rawName:"v-show",value:t.isShowBack,expression:"isShowBack"}],nativeOn:{click:function(e){return t.backitem.apply(null,arguments)}}})],1)},o=[],r=s("2909"),a=s("7fae"),i=s("5d17");function c(t,e){var s=null;return function(){for(var n=this,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];s&&clearTimeout(s),s=setTimeout((function(){t.apply(n,r)}),e)}}var l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("scroll",{staticClass:"level"},[s("div",{staticClass:"recommend"},t._l(t.recommends.slice(0,4),(function(e){return s("div",{key:e.id,staticClass:"recommend-item"},[s("a",{attrs:{href:""}},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.cover_url,expression:"item.cover_url"}],attrs:{alt:""}}),s("div",[t._v(t._s(e.title))])])])})),0)])},u=[],f={name:"recommendView",components:{Scroll:i["a"]},props:{recommends:{type:Array,default:function(){return[]}}}},d=f,p=(s("60ba"),s("2877")),m=Object(p["a"])(d,l,u,!1,null,"fac4b5e4",null),h=m.exports,v=s("5ad3"),b=s("6d71"),g=s("f8c8"),y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("van-swipe",{staticClass:"my-swipe",attrs:{autoplay:3e3,"indicator-color":"white"}},t._l(t.banners,(function(e){return s("van-swipe-item",[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.img_url,expression:"item.img_url"}],attrs:{alt:""},on:{load:t.bannersLoad}})])})),1)},w=[],_={name:"Swiper",props:{banners:{type:Array,default:[]}},components:{},data:function(){return{flay:!1}},methods:{bannersLoad:function(){this.flay||(this.$emit("bannersLoad"),this.flay=!0)}}},T=_,C=(s("40b9"),Object(p["a"])(T,y,w,!1,null,"0e37247a",null)),$=C.exports,x=s("1bab");function O(){return Object(x["a"])({url:"/api/index"})}function k(t,e){return Object(x["a"])({url:"/api/index?"+t+"=1&page="+e})}var G={name:"Home",components:{NavBar:a["a"],Scroll:i["a"],GoodsList:b["a"],TabControl:v["a"],RecommendView:h,BackTop:g["a"],Swiper:$},data:function(){return{recommends:[],goods:{sales:{page:0,list:[]},new:{page:0,list:[]},recommend:{page:0,list:[]}},goodsBanner:[],currentType:"sales",types:["sales","new","recommend"],isShowBack:!1,tabOffsetTop:0,isTabFixed:!1,saveY:0}},activated:function(){this.$refs.scroll.scrollTop(0,this.saveY,0),this.$refs.scroll.refresh()},deactivated:function(){this.saveY=this.$refs.scroll.saveY()},mounted:function(){var t=this;this.getHomeAllData(),this.getHomeGoods("sales"),this.getHomeGoods("new"),this.getHomeGoods("recommend"),k().then((function(e){var s;(s=t.goodsBanner).push.apply(s,Object(r["a"])(e.slides)),console.log(t.goodsBanner)}));var e=c(this.$refs.scroll.refresh,50);this.$bus.$on("itemImageLoad",(function(){e()}))},methods:{pullingUp:function(){this.getHomeGoods(this.currentType),this.$refs.scroll.refresh()},getHomeAllData:function(){var t=this;O().then((function(e){t.recommends=e.goods.data}))},getHomeGoods:function(t){var e=this,s=this.goods[this.currentType].page+1;k(t,s).then((function(s){var n;(n=e.goods[t].list).push.apply(n,Object(r["a"])(s.goods.data)),e.goods[t].page+=1,e.$refs.scroll.pullingUp()}))},itemTab:function(t){this.currentType=this.types[t],this.$refs.controlOffsetTop1.currentIndex=t,this.$refs.controlOffsetTop.currentIndex=t},backitem:function(){this.$refs.scroll.scrollTop(0,0)},scrollPotion:function(t){this.isShowBack=-t.y>500,this.isTabFixed=-t.y>this.tabOffsetTop},bannersLoad:function(){this.tabOffsetTop=this.$refs.OffsetHeight.offsetHeight}},computed:{showGoods:function(){return this.goods[this.currentType].list}}},L=G,j=(s("6c82"),Object(p["a"])(L,n,o,!1,null,"26b3d380",null));e["default"]=j.exports},c142:function(t,e,s){},d54c:function(t,e,s){}}]);
//# sourceMappingURL=chunk-514155ac.ce0c2635.js.map